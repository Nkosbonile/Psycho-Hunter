<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Murder Mystery Game Intro</title>
    <style>
        body { margin: 0; overflow: hidden; }
        canvas { display: block; }
        #introText {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Arial', sans-serif;
            font-size: 28px;
            color: white;
            text-align: center;
            max-width: 80%;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
        }
        #startButton {
            position: absolute;
            top: 80%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Arial', sans-serif;
            font-size: 20px;
            padding: 10px 20px;
            color: white;
            background-color: #444;
            border: none;
            cursor: pointer;
            display: none;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.6);
        }
        #startButton:hover {
            background-color: #555;
        }
    </style>
</head>
<body>
    <div id="introText"></div>
    <button id="startButton" onclick="startGame()">Begin Investigation</button>

    <audio id="backgroundMusic" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/10/13/audio_5a57d4537f.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <script>
        let scene, camera, renderer;
        let introText = document.getElementById('introText');
        let startButton = document.getElementById('startButton');
        let backgroundMusic = document.getElementById('backgroundMusic');
        const introLines = [
            "A cold night... A lifeless body discovered.",
            "No witnesses. No suspects.",
            "The police hit a dead end...",
            "That's where you come in.",
            "Every clue matters. Every word hides a secret.",
            "Your mission: Unravel the truth before it's too late."
        ];

        function init() {
            // Initialize Three.js scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000000);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 15;

            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            const backgroundTexture = new THREE.TextureLoader().load(
                'https://via.placeholder.com/800x600/000000/FFFFFF?text=Murder+Scene+Background'
            );
            const background = new THREE.Mesh(
                new THREE.PlaneGeometry(100, 75),
                new THREE.MeshBasicMaterial({ map: backgroundTexture })
            );
            background.position.set(0, 0, -10);
            scene.add(background);

            addAnimatedEvidence();
            introAnimation();
            window.addEventListener('resize', onWindowResize, false);
        }

        function addAnimatedEvidence() {
            const loader = new THREE.TextureLoader();

            const glass = new THREE.Mesh(
                new THREE.CircleGeometry(1, 32),
                new THREE.MeshBasicMaterial({ 
                    map: loader.load('https://via.placeholder.com/100/FFFFFF/000000?text=Magnifying+Glass') 
                })
            );
            glass.position.set(-3, 1, 0);
            scene.add(glass);

            function animateGlass() {
                requestAnimationFrame(animateGlass);
                glass.rotation.z += 0.01;
            }
            animateGlass();

            const question = new THREE.Mesh(
                new THREE.CircleGeometry(0.5, 32),
                new THREE.MeshBasicMaterial({ 
                    map: loader.load('https://via.placeholder.com/100/FFFFFF/000000?text=?') 
                })
            );
            question.position.set(2, 1, 0);
            scene.add(question);

            function animateQuestion() {
                requestAnimationFrame(animateQuestion);
                question.rotation.z += 0.02;
            }
            animateQuestion();
        }

        function introAnimation() {
            let cameraMove = { z: 30 };

            new TWEEN.Tween(cameraMove)
                .to({ z: 15 }, 5000)
                .easing(TWEEN.Easing.Cubic.Out)
                .onUpdate(() => {
                    camera.position.z = cameraMove.z;
                })
                .onComplete(() => {
                    backgroundMusic.play();
                    showIntroText(0);
                })
                .start();

            animate();
        }

        function showIntroText(lineIndex) {
            if (lineIndex >= introLines.length) {
                setTimeout(() => startButton.style.display = 'block', 2000);
                return;
            }

            introText.innerText = introLines[lineIndex];
            introText.style.opacity = 1;

            setTimeout(() => {
                introText.style.opacity = 0;
                setTimeout(() => showIntroText(lineIndex + 1), 1000); // Delay before next line
            }, 3000); // Time each line stays visible
        }

        function startGame() {
            introText.style.opacity = 0;
            startButton.style.display = 'none';
            backgroundMusic.pause();
             window.location.href = 'main.html'; 
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            TWEEN.update();
            renderer.render(scene, camera);
        }

        init();

    </script>
</body>
</html>
